<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Gabriel N√ºtzi, gabriel.nuetzi@sdsc.ethz.ch">
  <meta name="author" content="Cyril Matthey-Doret, cyril.matthey-doret@epfl.ch">
  <title>Nix Workshop Ôåì</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js@5.1.0/dist/reset.css">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js@5.1.0/dist/reveal.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: visible;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>

  <link rel="stylesheet" href="dist/theme/company.css" />
  <link rel="stylesheet" href="plugin/highlight/styles/railscasts.css" />

  <script>
      // If decktape export we need to load some other css
      // Emoji-Convertion
      if (window.location.search.match(/decktape/gi)) {
        let link = document.createElement("link")
        link.rel = "stylesheet"
        link.type = "text/css"
        link.href = "css/print/decktape.css"
        document.getElementsByTagName("head")[0].appendChild(link)
      }
    </script>

  <link rel="stylesheet" href="presentations/part-1/css/custom.css"/>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Nix Workshop Ôåì</h1>
  <h3 class="subtitle"><p>Part 1: Nix, Flakes &amp; Nix
DevShell<br></p></h3>
  <p class="author"><strong>Gabriel N√ºtzi</strong>, <a
href="mailto:gabriel.nuetzi@sdsc.ethz.ch">gabriel.nuetzi@sdsc.ethz.ch</a></p>
  <p class="author"><strong>Cyril Matthey-Doret</strong>, <a
href="mailto:cyril.matthey-doret@epfl.ch">cyril.matthey-doret@epfl.ch</a></p>
  <p class="date"><p>May 8, 2025, <a
href="https://github.com/sdsc-ordes/nix-workshop"
target="_blank">Repository</a>, <a
href="https://sdsc-ordes.github.io/technical-presentation/gh-pages/nix-workshop/part-1"
target="_blank">Slides</a></p></p>
  <aside class="notes">
    <p><ul>
<li><p>Welcome ‚Ä¶</p></li>
<li><p>As we have been using Nix for quite a while now, in quite some
repositories (I would say to a successful extent), I have been deploying
a Gitlab Runner VM with Nix etc, I thought its now a good time to give
you some more terminology and explanations what Nix is, what a flake is
and what the hack a DevShell is.</p></li>
<li><p>This will be structured possibly in two parts 1, since when I
prepared the slides from the Markdown write-up I figured out it needs
some more examples/explanations. So we do the first part today, or at
least try which should give you some better understanding of what Nix
does for you.</p></li>
<li><p>So I hope after this presentation you will be a bit more prepped
towards working with this tool. Not to say its rather a methodology than
a tool!</p></li>
<li><p>It‚Äôs good to keep this slides open next to you during the
presentation, as I will give you some time to checkout the examples
your-self, so you can directly copy paste.</p></li>
</ul></p>
  </aside>
</section>

<section id="help" class="title-slide slide level1">
<h1>Help</h1>
<p>How to use these slides:</p>
<ul>
<li><kbd>S</kbd>: See the speaker notes.</li>
<li><kbd>Esc</kbd>: See all slides and jump around.</li>
<li><kbd>Space</kbd>: Go forward.</li>
<li><kbd>Shift</kbd> + <kbd>Space</kbd>: Go backward.</li>
</ul>
</section>

<section>
<section id="acknowledgment" class="title-slide slide level1">
<h1>Acknowledgment</h1>
<p>Thanks to the following contributors:</p>
<ul>
<li><p><a href="mailto:cyril.matthey-doret@epfl.ch">Cyril
Matthey-Doret</a> for reviewing the initial draft.</p></li>
<li><p><a href="farid.m.zakaria@gmail.com">Farid Zakaria</a> for giving
the talk at PlanetNix 2025 which we see in the intro.</p></li>
<li><p>The Nix Community at</p>
<ul>
<li><a href="https://discourse.nixos.org"
target="_blank">https://discourse.nixos.org</a></li>
<li><a href="https://matrix.to/#/#community:nixos.org"
target="_blank">https://matrix.to/#/#community:nixos.org</a></li>
</ul></li>
</ul>
<!-- markdownlint-disable-file MD034 MD033 MD001 MD024 MD026-->
</section>
<section id="requirements" class="slide level2">
<h2>Requirements</h2>
<p>All examples refer to the <a
href="https://github.com/sdsc-ordes/nix-workshop/blob/main/examples/what-is-my-ip-orig.nix"
target="_blank">workshop repository</a> in the root directory.</p>
<p>Ensure that you have installed <a
href="https://swissdatasciencecenter.github.io/best-practice-documentation/docs/dev-enablement/nix-and-nixos#installing-nix"
target="_blank"><code>Nix</code></a> and <a
href="https://swissdatasciencecenter.github.io/best-practice-documentation/docs/dev-enablement/nix-and-nixos#installing-direnv"
target="_blank"><code>direnv</code></a>.</p>
<p>The basic requirements for working with this repository are:</p>
<ul>
<li><code>just</code></li>
<li><code>nix</code></li>
</ul>
<p>See <a
href="https://swissdatasciencecenter.github.io/best-practice-documentation/docs/dev-enablement/nix-and-nixos"
target="_blank">instructions</a>.</p>
<p>ü™ü Windows Users: kindly asked to leave this presentation (since Nix
is for Unix system) <strong>or</strong> use <strong>WSL
Ubuntu</strong>.</p>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="introduction" class="title-slide slide level1">
<h1>Introduction</h1>

</section>
<section id="why-nix" class="slide level2">
<h2>Why Nix</h2>
<p>We will see in a minute!</p>
<aside class="notes">
<p>Before we jump into the presentation from Farid, lets do quickly
short wrap up of the Nix language that you can read already some of the
code he presents.</p>
</aside>
</section>
<section id="what-is-nix" class="slide level2">
<h2>What is Nix</h2>
<div>
<ul>
<li class="fragment"><p>A <em>domain-specific</em>
<strong>functional</strong> language (<strong>no
side-effects</strong>).</p></li>
<li class="fragment"><p>Structurally similar to JSON but with <a
href="https://nixos.org/guides/nix-pills/05-functions-and-imports.html"
target="_blank"><em>functions</em></a>.</p></li>
<li class="fragment"><p>Supports fundamental data types such as
<code>string</code>, <code>integer</code>, <code>path</code>,
<code>list</code>, and <code>attribute set</code>. See <a
href="https://nixos.org/guides/nix-pills/04-basics-of-language.html#basics-of-language"
target="_blank">Nix Language Basics</a>.</p></li>
<li class="fragment"><p><strong>Lazy evaluated</strong>, <em>expression
evaluation delayed until needed</em>.</p></li>
<li class="fragment"><p>‚ö†Ô∏èThe Nix language is <strong>specifically
designed</strong> for <strong>deterministic/reproducible</strong>
software deployment.</p></li>
</ul>
</div>
<aside class="notes">
<p>The Nix language is specifically designed for deterministic software
building and distribution. Due to its narrow scope, it lacks certain
features, such as floating-point types, which are unnecessary in this
context.</p>
</aside>
</section>
<section id="nix-language" class="slide level2">
<h2>Nix Language</h2>
<div>
<ul>
<li class="fragment"><p>Nix files have suffix <code>.nix</code> and
contain mostly 1 <a
href="https://nixos.org/guides/nix-pills/05-functions-and-imports.html"
target="_blank"><em>function</em></a>.</p></li>
<li class="fragment"><p>The function <code>args: ...</code> in file
<code>myfunction.nix</code> takes one argument <code>banana</code>
and</p>
<pre class="nix" data-line-numbers="2|3|4|5|6|7|8|9"><code># myfunction.nix
banana:
let
  aNumber = 1;  # A number.
  aList = [ 1 2 3 &quot;help&quot;];  # A list with 4 elements.
  anAttrSet = { a = 1; b.c.d = [1]; };  # A nested attribute set.
  result = banana.getColor { v = aNumber; };  # Calls another function `args.myFunc`.
in
{ x = aNumber; y = anAttrSet.b.c.d; z = result; }</code></pre>
<p>returns an attribute set <code>{ x = ... }</code>.</p></li>
<li class="fragment"><p>Watch this <a
href="https://www.youtube.com/watch?v=HiTgbsFlPzs" target="_blank">short
introduction</a> for the basic building block.</p></li>
</ul>
</div>
</section>
<section id="examples" class="slide level2">
<h2>Examples</h2>
<p>Verify the next examples in the Nix REPL (Read-Eval-Print-Loop):</p>
<pre class="bash"><code>nix repl</code></pre>
<p>or pass std. input to <code>nix eval</code>:</p>
<pre class="bash"><code>echo &#39;
  let a = 3; in a
&#39; | nix eval --file -</code></pre>
<p><strong>In <a
href="https://github.com/sdsc-ordes/nix-workshop/blob/main/examples/what-is-my-ip-orig.nix"
target="_blank">workshop repository</a></strong>:</p>
<pre class="bash"><code>echo &#39;3&#39; | just eval</code></pre>
</section>
<section id="examples-1" class="slide level2">
<h2>Examples</h2>
<div class="columns">
<div class="column" style="width:50%;">
<pre class="nix fragment" data-line-numbers="2|3|5|6"><code>let # start for &quot;procedural&quot; statements
 mult = a: b: a * b;
 x10 = mult 10; # Bind the first arg.
in
x10 (mult 8 2)
# -&gt; 160</code></pre>
<pre class="nix fragment" data-line-numbers="2|2-4|7|8"><code>let
f = args: {
  a = args.banana + &quot;-nice&quot;;
  b = args.orange + &quot;-sour&quot;;
};
in
f { banana = &quot;1&quot;; orange = &quot;2&quot; }
# -&gt; { a = &quot;1-nice&quot;; b = &quot;2-sour&quot;; }</code></pre>
</div><div class="column" style="width:50%;">
<pre class="nix fragment" data-line-numbers="2|2-4|7|8"><code>let
f = { ban, ora, ...}: { # Destructuring
  a = ban + &quot;-nice&quot;;
  b = ora + &quot;-sour&quot;;
};
in
f { ban = &quot;1&quot;; ora = &quot;2&quot;; berry =&quot;3&quot;; }
# -&gt; { a = &quot;1-nice&quot;; b = &quot;2-sour&quot;; }</code></pre>
<pre class="nix fragment" data-line-numbers="2|3|5|6"><code>let
f = list: {
  a = builtins.map (x: x*x) list;
};
in f [ 1 3 9 ]
# -&gt; { a = [ 1 9 81 ] }</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="more-examples">More Examples</h3>
<div class="columns">
<div class="column" style="width:50%;">
<pre class="nix fragment" data-line-numbers="2|3"><code># Concat lists.
[ 1 2 3 ] ++ [ 1 2 3 ]
# [ 1 2 3 1 2 3 ];</code></pre>
<pre class="nix fragment" data-line-numbers="2|3"><code># Merge attribute sets.
{ a = 1; b = 2; } // { a = 2; c = 3; }
# -&gt; { a = 2; b = 2; c = 3; }</code></pre>
<pre class="nix fragment" data-line-numbers="1-5|2|3|4|6"><code>rec {
  b = 2;
  c = b + d:
  d = 10;
}
# -&gt; { b = 2; c = 12; d = 10; }</code></pre>
</div><div class="column" style="width:50%;">
<pre class="nix fragment" data-line-numbers="3|5|6"><code># Lazy evaluation.
let
  x = abort &quot;fail&quot;;
in
if false then x else 42
# -&gt; 42</code></pre>
<pre class="nix fragment" data-line-numbers="3|4"><code># Import files.
let
  myfunc = import ./myfunction.nix;
in myfunc 1 + (import ./other.nix 3)</code></pre>
</div>
</div>
</section>
<section id="attribute-set-building-inherit" class="slide level2">
<h2>Attribute Set Building: <code>inherit</code></h2>
<pre class="nix fragment" data-line-numbers="3|4|5|8|9"><code># Inherit &#39;key = value&#39;.
let
  width = 100;
  color = &quot;blue&quot;;
  set = { b = 1; };
in
{
  inherit color;   # color = color;
  inherit (set) b; # b     = set.b;
}</code></pre>
</section>
<section id="variable-interpolation" class="slide level2">
<h2>Variable Interpolation</h2>
<pre class="nix fragment" data-line-numbers="2|3|4-6|7"><code>let
  key = &quot;c&quot;
  color = &quot;blue&quot;;
  set = {
    c = { v = &quot;hello-${color}&quot; ;}
  };
in set.${key}.v

# -&gt; &quot;hello-blue&quot;</code></pre>
</section>
<section id="strings-and-paths" class="slide level2">
<h2>Strings and Paths</h2>
<pre class="nix" data-line-numbers="2|3|5"><code>let
  dir = ./.github/workflows;    # A path. Nix makes them absolute!
  file = &quot;${file}/gh-pages.yaml&quot;; # Interpolated path gets added into the `/nix/store`.
in file
# -&gt; &quot;/nix/store/w9il9gvki2nfdzfc1lrlbiv3xy3mx90a-workflows/gh-pages.yaml&quot;</code></pre>
</section>
<section id="caution-with-let-statements" class="slide level2">
<h2>Caution With <code>let</code> Statements</h2>
<p>Do not reassign in <code>let</code> blocks:</p>
<pre class="nix" data-line-numbers="2|3|3,6"><code>let
  a = &quot;hello&quot;;
  a = a + &quot;world&quot;;
  #   ^
  #   |
  #  üÜò Endless recursion, this is not reassigning.
in a</code></pre>
<div class="fragment">
<p>‚úÖ Configure <a href="https://github.com/nix-community/nixd"
target="_blank"><code>nixd</code></a> (Nix Language Server) in your IDE
to see ‚ÄúGo to definitions‚Äù.</p>
</div>
</section>
<section id="fixed-point-combinator" class="slide level2">
<h2>Fixed Point Combinator ü§Ø</h2>
<p>In maths a fix point <code>x</code> of a function <code>f</code> is
defined as:</p>
<p><span class="math display">\[
x = f(x).
\]</span></p>
<div class="fragment">
<p>In functional programming a fix-point <strong>combinator</strong>
<code>fix</code> is a <em>higher-order</em> function.<br> It returns the
fix point of a function <code>g</code>:</p>
</div>
<div class="fragment">
<pre class="nix"><code> fix = g: g (fix g)</code></pre>
</div>
<div class="fragment">
<p>Really?</p>
<p>Apply <code>fix</code> to a function <code>f</code> and see what it
returns:</p>
<p><span class="math display">\[
\underbrace{\text{fix}(f)}_{x} = f( \underbrace{\text{fix}(f)}_{x} )
\]</span></p>
</div>
</section>
<section id="fixed-point-combinator-1" class="slide level2">
<h2>Fixed-Point Combinator ü§Ø</h2>
<p>That is how recursive self-referential sets can be defined.</p>
<pre class="nix" data-line-numbers="2|5|7|9"><code>let
  fix = g: g (fix g); # Fix-point combinator.

  # Define the constructor.
  newSet = self: { path = &quot;/bin&quot;; full = self.path + &quot;/my-app&quot;; };

  mySet = fix newEnv;               # fulfills: myEnv == fix myEnv;
in
  mySet.full</code></pre>
<p>Seems recursive: <code>fix</code> calls <code>fix</code> again
<strong>but isn‚Äôt ü§Ø</strong>, because its lazy evaluated. More
explanations here.</p>
<p>Used in <code>pkgs.callPackage</code> in <code>nixpkgs</code>.</p>
</section>
<section id="learn-nix-the-fun-way" class="slide level2">
<h2>Learn Nix the Fun Way</h2>
<h3 id="learn-nix-the-fun-way-1"><a
href="https://fzakaria.github.io/learn-nix-the-fun-way"
target="_blank">Learn Nix the Fun Way</a></h3>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="workshop" class="title-slide slide level1">
<h1>Workshop</h1>

</section>
<section id="building-package" class="slide level2">
<h2>Building Our First Package (1)</h2>
<p>Put the following in a script <a
href="https://github.com/sdsc-ordes/nix-workshop/blob/main/examples/what-is-my-ip.nix"
target="_blank"><code>whats-is-my-ip.nix</code></a>:</p>
<pre class="nix" data-line-numbers="2|3|4-7"
style="font-size:14pt"><code>{
system ? builtins.currentSystem, # Mostly: x86_64-linux
pkgs ?
  import (builtins.fetchTarball
    &quot;https://github.com/NixOS/nixpkgs/archive/9684b53175fc6c09581e94cc85f05ab77464c7e3.tar.gz&quot;) {
    inherit system;
  },
}:
pkgs.writeShellScriptBin &quot;what-is-my-ip&quot; &#39;&#39;
  ${pkgs.curl}/bin/curl -s http://httpbin.org/get | \
    ${pkgs.jq}/bin/jq --raw-output .origin
&#39;&#39;</code></pre>
<div class="fragment quiz">
<p><em><strong>Quiz:</strong> What returns
<code>builtins.fetchTarball "..."</code>?</em></p>
</div>
<aside class="notes">
<p>This function takes two parameters:</p>
<ul>
<li><code>system</code>: a string mostly <code>x86_64-linux</code> and
defaulted to your current system) and</li>
<li><code>pkgs</code>: an attribute set and defaulted to the main
function of the <code>nixpkgs</code> repository. The repository
<code>nixpkgs</code> is the central package mono-repository which
maintains packages (<em>derivations</em>) for Nix.</li>
</ul>
</aside>
</section>
<section id="building-our-first-package-2" class="slide level2">
<h2>Building Our First Package (2)</h2>
<pre class="bash"><code>nix build -f ./examples/what-is-my-ip.nix --print-out-paths

&gt; &quot;/nix/store/7x9hf9g95d4wjjvq853x25jhakki63bz-what-is-my-ip&quot;</code></pre>
<div class="fragment">
<p>Explore whats in this file
<code>/nix/store/7x9hf9g95d4wjjvq853x25jhakki63bz-what-is-my-ip/bin/what-is-my-ip</code>:</p>
<pre class="bash"><code>#!/nix/store/mc4485g4apaqzjx59dsmqscls1zc3p2w-bash-5.2p37/bin/bash
/nix/store/zl7h70n70g5m57iw5pa8gqkxz6y0zfcf-curl-8.12.1-bin/bin/curl \
  -s &quot;http://httpbin.org/get&quot; | \
  /nix/store/y50rkdixqzgdgnps2vrc8g0f0kyvpb9w-jq-1.7.1-bin/bin/jq \
    --raw-output &quot;.origin&quot;</code></pre>
<p>Nix has encoded the executables used by <strong>store paths</strong>
(<code>/nix/store</code>).</p>
</div>
<div class="fragment quiz">
<p><em><strong>Quiz:</strong> Can you share this script with your
colleague?</em></p>
</div>
<aside class="notes">
<p>Do not think you can now simply share this script by giving the
contents of directory
<code>/nix/store/7x9hf9g95d4wjjvq853x25jhakki63bz-what-is-my-ip</code>
to somebody else and it will work. This is not sufficient as we need the
other derivations as well. This is done differently namely over Nix
itself, because Nix has all information (<code>nix copy</code>).</p>
</aside>
</section>
<section id="building-our-first-package-3" class="slide level2">
<h2>Building Our First Package (3)</h2>
<pre class="nix"><code>pkgs.writeShellScriptBin &quot;what-is-my-ip&quot; &#39;&#39;
  ${pkgs.curl}/bin/curl -s http://httpbin.org/get | \
    ${pkgs.jq}/bin/jq --raw-output .origin
&#39;&#39;</code></pre>
<p>The <code>pkgs.writeShellScriptBin</code> is a <strong>trivial
builder</strong> function around the fundamental <code>derivation</code>
command (see <a
href="https://github.com/sdsc-ordes/nix-workshop/blob/main/examples/what-is-my-ip-orig.nix"
target="_blank">./examples/what-is-my-ip-orig.nix</a>):</p>
</section>
<section class="slide level2">

<pre class="nix" data-line-numbers="1|2|4|5|7-20|10|12-16|22,10"
style="font-size:14pt;"><code>derivation {
  inherit system;

  name = &quot;what-is-my-ip&quot;;
  builder = &quot;/bin/sh&quot;;

  args = [
    &quot;-c&quot;
    &#39;&#39;
      ${pkgs.coreutils}/bin/mkdir -p $out/bin

      {
        echo &#39;#!/bin/sh&#39;
        echo &#39;${pkgs.curl}/bin/curl -s http://httpbin.org/get | \
        ${pkgs.jq}/bin/jq --raw-output .origin&#39;
      } &gt; $out/bin/what-is-my-ip

      ${pkgs.coreutils}/bin/chmod +x $out/bin/what-is-my-ip
    &#39;&#39;
  ];

  outputs = [ &quot;out&quot; ];
}</code></pre>
</section>
<section id="inspect-the-dependency-graph" class="slide level2">
<h2>Inspect the Dependency Graph</h2>
<p>Run</p>
<pre class="bash"><code>nix run github:craigmbooth/nix-visualize -- \
  -c tools/configs/nix-visualize/config.ini \
  -s nix \
  &quot;$(nix build -f ./examples/what-is-my-ip.nix --print-out-paths)&quot;</code></pre>
<p>and inspect <code>frame.png</code>.</p>
<div class="center-content p-no-margin">
<p><img
data-src="presentations/part-1/assets/images/convert/3bca0a4bf98adc84b883941cb7326277e2017cc3.png"
class="border-light" style="width:50.0%" /></p>
</div>
</section>
<section id="inspect-the-dependency-graph-2" class="slide level2">
<h2>Inspect the Dependency Graph (2)</h2>
<div class="quiz">
<p><em><strong>Quiz:</strong> What do you expect<br>
<code>/nix/store/zl7h70n70g5m57iw5pa8gqkxz6y0zfcf-curl-8.12.1-bin/bin/curl</code><br>
links to and what does your system <code>curl</code> link to? <br><br>
Use <code>ldd curl</code> to inspect.</em></p>
</div>
<aside class="notes">
<p>Nix builds in a sandbox where only <code>/nix/store</code> (and some
others, +no internet) is available. Any build tool which is used during
the build of a Nix derivation will typically only pick up these
libraries from the <code>/nix/store</code> (any linker will link to
these files). For <code>pkgs.writeShellScriptBin</code> it will also
analyze the output script for store paths and include these in the
runtime dependencies.</p>
</aside>
</section>
<section id="what-is-a-flake" class="slide level2">
<h2>What Is a Flake?</h2>
<p>You have seen files like <code>flake.nix</code> lying around in
repositories already.</p>
<p>A <a href="./flake.nix"><code>flake.nix</code></a> provides</p>
<div>
<ul>
<li class="fragment"><p>a <strong>deterministic</strong> way to manage
dependencies and configurations in Nix <a
href="https://www.youtube.com/live/yhfDtRRTmY8?si=xTjOKKIWIZPIwoU3&amp;t=18317"
target="_blank">(Slide of the Nix Founder)</a>.</p></li>
<li class="fragment"><p>comes with a <code>flake.lock</code> file which
locks dependencies.</p></li>
</ul>
</div>
<div class="fragment">
<p><a href="#/building-package">Remember <code>fetchTarball "..."</code>
in <code>what-is-my-ip.nix</code></a> which locks <code>pkgs</code> to a
certain commit on the <code>nixpkgs</code> repository, a flake is a
better way to manage locked inputs.</p>
</div>
</section>
<section id="what-is-a-flake-2" class="slide level2">
<h2>What Is a Flake (2)</h2>
<p>A flake</p>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment"><p>references external Nix functions - called <a
href="https://nixos-and-flakes.thiscute.world/nixos-with-flakes/nixos-flake-configuration-explained#_1-flake-inputs"
target="_blank"><strong>inputs</strong></a>.</p>
<ul>
<li class="fragment">Other repositories, local files, or URLs with a
<code>flake.nix</code>.</li>
</ul></li>
<li class="fragment"><p>defines structured <a
href="https://nixos-and-flakes.thiscute.world/other-usage-of-flakes/outputs"
target="_blank"><strong>outputs</strong></a> (a function)</p>
<ul>
<li class="fragment">Specifies what the flake provides.</li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<pre class="nix"><code>{
  inputs = { /* ... */ };

  outputs = inputs: {
    packages = /* implementation */

    # ... other output attributes ...
  }
}</code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li><strong>Inputs</strong>: An attribute set <code>inputs</code>,
listing dependencies the flake relies on.</li>
<li><strong>Outputs</strong>: A function that takes all
<code>inputs</code> and returns an <a
href="https://nixos-and-flakes.thiscute.world/other-usage-of-flakes/outputs"
target="_blank"></a>, specifying what the flake provides (e.g.,
packages, modules, or NixOS configurations).</li>
</ul>
</aside>
</section>
<section id="what-is-a-flake-3" class="slide level2">
<h2>What Is A Flake? (3)</h2>
<div>
<ul>
<li class="fragment"><p>Nix can evaluate a <code>flake.nix</code> by
calling the <code>outputs</code> function passing all
<code>inputs</code>.</p>
<ul>
<li class="fragment"><p>Try <code>nix repl .</code> to load all outputs
of <code>./flake.nix</code> in directory <code>.</code>.</p></li>
<li class="fragment"><p>Check
<code>outputs.packages.x86_64-linux = { ... }</code>. It is a flat
attribute set of Nix <strong>derivations</strong>.</p></li>
</ul></li>
</ul>
</div>
<aside class="notes">
<p>Another method is to start the <code>nix repl</code> and then type
<code>:lf .</code> which is almost the same except that the available
attributes are now <code>inputs</code> and <code>outputs</code>:</p>
</aside>
</section>
<section id="what-is-a-nix-derivation" class="slide level2">
<h2>What Is a Nix Derivation?</h2>
<p>A <a href="https://nix.dev/manual/nix/2.24/glossary#gloss-derivation"
target="_blank">derivation</a> is a</p>
<ul>
<li><p><strong>specialized attribute set</strong>, describes how to
<strong>build</strong> a Nix package.</p>
<pre class="nix"><code>{ type = &quot;derivation&quot;; ... }</code></pre>
<p>Check <code>nix repl -f &lt;nixpkgs&gt;</code> and type
<code>pkgs.curl.type</code>.</p></li>
</ul>
<aside class="notes">
<p>A <a href="https://nix.dev/manual/nix/2.24/glossary#gloss-derivation"
target="_blank">derivation</a> is a <strong>specialized attribute
set</strong> that describes how to build a Nix package. In raw form, it
looks like <code>{ type = "derivation"; ... }</code> and carries a
well-defined structure with built-in meaning.</p>
</aside>
</section>
<section id="derivation-definition" class="slide level2">
<h2>Derivation Definition</h2>
<blockquote>
<p>A <strong>derivation</strong> is an instruction that Nix uses to
realize a package. Created using a special <code>derivation</code>
function in the Nix language, it can depend on multiple other
derivations and produce one or more outputs. The complete set of
dependencies required to build a derivation‚Äîincluding its transitive
dependencies‚Äîis called a <strong>closure</strong>. <a
href="https://zero-to-nix.com/concepts/derivations"
target="_blank">[Ref]</a></p>
</blockquote>
</section>
<section id="evaluating-a-derivation" class="slide level2">
<h2>Evaluating a Derivation</h2>
<p>When Nix evaluates a derivation, it stores the result in the Nix
store (<code>/nix/store</code>) as a <strong>store derivation</strong>
(<a
href="https://nix.dev/manual/nix/2.24/glossary#gloss-store-derivation"
target="_blank">more details</a>).</p>
<img
data-src="presentations/part-1/assets/images/convert/7fceeb280416a3d5d2518d57fa9a6f119e7f2a6f.svg" />
</section>
<section id="inspect-a-derivation" class="slide level2">
<h2>Inspect a Derivation</h2>
<pre class="bash"><code>nix eval &quot;./examples/flake-simple#packages.x86_64-linux.mytool&quot;

&gt; ¬´derivation /nix/store/l8pma77py04gd5819zkk3h7jx0bgxqgm-mytool.drv¬ª</code></pre>
<p><code>./examples/flake-simple#packages.x86_64-linux.mytool</code> is
an <em>installable</em>. More later!</p>
<div class="fragment">
<pre class="bash"><code># Inspect the store derivation.
cat /nix/store/l8pma77py04gd5819zkk3h7jx0bgxqgm-mytool.drv</code></pre>
</div>
<aside class="notes">
<p>Realize that even when you are on macOS <code>aarch64-darwin</code>,
that we can evaluate the derivation for another architecture.</p>
</aside>
</section>
<section id="inspect-a-derivation-2" class="slide level2">
<h2>Inspect a Derivation (2)</h2>
<pre class="bash"><code>&gt; Derive([(&quot;out&quot;,&quot;/nix/store/5rvqlxk2vx0hx1yk8qdll2l8l62pfn8n-treefmt&quot;,&quot;&quot;,&quot;&quot;)],
[(&quot;/nix/store/1fmb3b4cmr1bl1v6vgr8plw15rqw5jhf-treefmt.toml.drv&quot;,[&quot;out&quot;]),
(&quot;/nix/store/3avbfsh9rjq8psqbbplv2da6dr679cib-treefmt-2.1.0.drv&quot;,[&quot;out&quot;]),
(&quot;/nix/store/61fjldjpjn6n8b037xkvvrgjv4q8myhl-bash-5.2p37.drv&quot;,[&quot;out&quot;]),
(&quot;/nix/store/gp6gh2jn0x7y7shdvvwxlza4r5bmh211-stdenv-linux.drv&quot;,[&quot;out&quot;])]
,[&quot;/nix/store/v6x3cs394jgqfbi0a42pam708flxaphh-default-builder.sh&quot;]
,&quot;x86_64-linux&quot;,&quot;/nix/store/8vpg72ik2kgxfj05lc56hkqrdrfl8xi9-bash-5.2p37/bin/bash&quot;,
[&quot;-e&quot;,&quot;/nix/store/v6x3cs394jgqfbi0a42pam708flxaphh-default-builder.sh&quot;],
[ (&quot;__structuredAttrs&quot;,&quot;&quot;),(&quot;allowSubstitutes&quot;,&quot;&quot;),
(&quot;buildCommand&quot;,&quot;target=$out/bin/treefmt\nmkdir -p \&quot;$(dirname \&quot;$target\&quot;)\&quot;\n\nif [ -e \&quot;$textPath\&quot; ]; then\n  mv \&quot;$textPath\&quot; \&quot;$target\&quot;\nelse\n  echo -n \&quot;$text\&quot; &gt; \&quot;$target\&quot;\nfi\n\nif [ -n \&quot;$executable\&quot; ]; then\n  chmod +x \&quot;$target\&quot;\nfi\n\neval \&quot;$checkPhase\&quot;\n&quot;),(&quot;buildInputs&quot;,&quot;&quot;),(&quot;builder&quot;,&quot;/nix/store/8vpg72ik2kgxfj05lc56hkqrdrfl8xi9-bash-5.2p37/bin/bash&quot;),(&quot;checkPhase&quot;,&quot;/nix/store/8vpg72ik2kgxfj05lc56hkqrdrfl8xi9-bash-5.2p37/bin/bash -n -O extglob \&quot;$target\&quot;\n&quot;),(&quot;cmakeFlags&quot;,&quot;&quot;),(&quot;configureFlags&quot;,&quot;&quot;),(&quot;depsBuildBuild&quot;,&quot;&quot;),(&quot;depsBuildBuildPropagated&quot;,&quot;&quot;),(&quot;depsBuildTarget&quot;,&quot;&quot;),(&quot;depsBuildTargetPropagated&quot;,&quot;&quot;),(&quot;depsHostHost&quot;,&quot;&quot;),(&quot;depsHostHostPropagated&quot;,&quot;&quot;),(&quot;depsTargetTarget&quot;,&quot;&quot;),(&quot;depsTargetTargetPropagated&quot;,&quot;&quot;),(&quot;doCheck&quot;,&quot;&quot;),(&quot;doInstallCheck&quot;,&quot;&quot;),(&quot;enableParallelBuilding&quot;,&quot;1&quot;),(&quot;enableParallelChecking&quot;,&quot;1&quot;),(&quot;enableParallelInstalling&quot;,&quot;1&quot;),(&quot;executable&quot;,&quot;1&quot;),(&quot;mesonFlags&quot;,&quot;&quot;),(&quot;name&quot;,&quot;treefmt&quot;),(&quot;nativeBuildInputs&quot;,&quot;&quot;),(&quot;out&quot;,&quot;/nix/store/5rvqlxk2vx0hx1yk8qdll2l8l62pfn8n-treefmt&quot;),(&quot;outputs&quot;,&quot;out&quot;),(&quot;passAsFile&quot;,&quot;buildCommand text&quot;),(&quot;patches&quot;,&quot;&quot;),(&quot;preferLocalBuild&quot;,&quot;1&quot;),(&quot;propagatedBuildInputs&quot;,&quot;&quot;),(&quot;propagatedNativeBuildInputs&quot;,&quot;&quot;),(&quot;stdenv&quot;,&quot;/nix/store/hsxp8g7zdr6wxk1mp812g8nbzvajzn4w-stdenv-linux&quot;),(&quot;strictDeps&quot;,&quot;&quot;),(&quot;system&quot;,&quot;x86_64-linux&quot;),(&quot;text&quot;,&quot;#!/nix/store/8vpg72ik2kgxfj05lc56hkqrdrfl8xi9-bash-5.2p37/bin/bash\nset -euo pipefail\nunset PRJ_ROOT\nexec /nix/store/0jcp33pgf85arjv3nbghws34mrmy7qq5-treefmt-2.1.0/bin/treefmt \\\n  --config-file=/nix/store/qk8rqccch6slk037dhnprryqwi8mv0xs-treefmt.toml \\\n  --tree-root-file=.git/config \\\n  \&quot;$@\&quot;\n\n&quot;)])</code></pre>
<div class="fragment">
<p>JSON output of the above:</p>
<pre class="bash"><code>nix derivation show /nix/store/l8pma77py04gd5819zkk3h7jx0bgxqgm-mytool.drv</code></pre>
</div>
<aside class="notes">
<p>The output of
<code>/nix/store/l8pma77py04gd5819zkk3h7jx0bgxqgm-mytool.drv</code>
above is the internal serialization of the formatter‚Äôs derivation which
<strong>when built</strong> can be used to format all files in this
repository.</p>
</aside>
</section>
<section id="inspect-a-derivation-1" class="slide level2">
<h2>Inspect a Derivation ()</h2>
<pre class="json" style="font-size:12pt"><code>{
  &quot;/nix/store/l8pma77py04gd5819zkk3h7jx0bgxqgm-mytool.drv&quot;: {
    &quot;args&quot;: [
      &quot;-e&quot;,
      &quot;/nix/store/vj1c3wf9c11a0qs6p3ymfvrnsdgsdcbq-source-stdenv.sh&quot;,
      &quot;/nix/store/shkw4qm9qcw5sc5n1k5jznc83ny02r39-default-builder.sh&quot;
    ],
    &quot;builder&quot;: &quot;/nix/store/9nw8b61s8lfdn8fkabxhbz0s775gjhbr-bash-5.2p37/bin/bash&quot;,
    &quot;env&quot;: {
      &quot;__structuredAttrs&quot;: &quot;&quot;,
      &quot;allowSubstitutes&quot;: &quot;&quot;,
      &quot;buildCommand&quot;: &quot;target=$out/bin/mytool\nmkdir -p \&quot;$(dirname \&quot;$target\&quot;)\&quot;\n\nif [ -e \&quot;$textPath\&quot; ]; then\n  mv \&quot;$textPath\&quot; \&quot;$target\&quot;\nelse\n  echo -n \&quot;$text\&quot; &gt; \&quot;$target\&quot;\nfi\n\nif [ -n \&quot;$executable\&quot; ]; then\n  chmod +x \&quot;$target\&quot;\nfi\n\neval \&quot;$checkPhase\&quot;\n&quot;,
      &quot;buildInputs&quot;: &quot;&quot;,
      &quot;builder&quot;: &quot;/nix/store/9nw8b61s8lfdn8fkabxhbz0s775gjhbr-bash-5.2p37/bin/bash&quot;,
      &quot;checkPhase&quot;: &quot;/nix/store/9nw8b61s8lfdn8fkabxhbz0s775gjhbr-bash-5.2p37/bin/bash -n -O extglob \&quot;$target\&quot;\n&quot;,
      &quot;cmakeFlags&quot;: &quot;&quot;,
      &quot;configureFlags&quot;: &quot;&quot;,
      &quot;depsBuildBuild&quot;: &quot;&quot;,
      &quot;depsBuildBuildPropagated&quot;: &quot;&quot;,
      &quot;depsBuildTarget&quot;: &quot;&quot;,
      &quot;depsBuildTargetPropagated&quot;: &quot;&quot;,
      &quot;depsHostHost&quot;: &quot;&quot;,
      &quot;depsHostHostPropagated&quot;: &quot;&quot;,
      &quot;depsTargetTarget&quot;: &quot;&quot;,
      &quot;depsTargetTargetPropagated&quot;: &quot;&quot;,
      &quot;doCheck&quot;: &quot;&quot;,
      &quot;doInstallCheck&quot;: &quot;&quot;,
      &quot;enableParallelBuilding&quot;: &quot;1&quot;,
      &quot;enableParallelChecking&quot;: &quot;1&quot;,
      &quot;enableParallelInstalling&quot;: &quot;1&quot;,
      &quot;executable&quot;: &quot;1&quot;,
      &quot;mesonFlags&quot;: &quot;&quot;,
      &quot;name&quot;: &quot;mytool&quot;,
      &quot;nativeBuildInputs&quot;: &quot;&quot;,
      &quot;out&quot;: &quot;/nix/store/blm702jzcwfppwrrj9925ivd9gxp4c9n-mytool&quot;,
      &quot;outputs&quot;: &quot;out&quot;,
      &quot;passAsFile&quot;: &quot;buildCommand text&quot;,
      &quot;patches&quot;: &quot;&quot;,
      &quot;preferLocalBuild&quot;: &quot;1&quot;,
      &quot;propagatedBuildInputs&quot;: &quot;&quot;,
      &quot;propagatedNativeBuildInputs&quot;: &quot;&quot;,
      &quot;stdenv&quot;: &quot;/nix/store/npp9k9062ny7w0k1i03ij6xvqb7vhvjh-stdenv-linux&quot;,
      &quot;strictDeps&quot;: &quot;&quot;,
      &quot;system&quot;: &quot;x86_64-linux&quot;,
      &quot;text&quot;: &quot;#!/nix/store/9nw8b61s8lfdn8fkabxhbz0s775gjhbr-bash-5.2p37/bin/bash\n\&quot;/nix/store/xkk1gr9bw2dbdjna8391rj1zl1l3dmhq-cowsay-3.8.4/bin/cowsay\&quot; \&quot;Hello there ;)\&quot;\necho \&quot;-------------------------------------\&quot;\n\&quot;/nix/store/4ydiim4lfk6nyab4pdkjj9s33pgbigfd-figlet-2.2.5/bin/figlet\&quot; \&quot;Do you expect\&quot;\n\&quot;/nix/store/4ydiim4lfk6nyab4pdkjj9s33pgbigfd-figlet-2.2.5/bin/figlet\&quot; \&quot;something \&quot;\n\&quot;/nix/store/4ydiim4lfk6nyab4pdkjj9s33pgbigfd-figlet-2.2.5/bin/figlet\&quot; \&quot;useful ? \&quot;\n\n&quot;
    },
    &quot;inputDrvs&quot;: {
      &quot;/nix/store/1fsd2cb5ab7ci01ks4j0gbbq254jw6sk-stdenv-linux.drv&quot;: {
        &quot;dynamicOutputs&quot;: {},
        &quot;outputs&quot;: [&quot;out&quot;]
      },
      &quot;/nix/store/lrf9kbhlaf5mkvnlf3zr9wzvk7c2z72l-bash-5.2p37.drv&quot;: {
        &quot;dynamicOutputs&quot;: {},
        &quot;outputs&quot;: [&quot;out&quot;]
      },
      &quot;/nix/store/phq4wh4490manblg905xixpc3gvwr149-figlet-2.2.5.drv&quot;: {
        &quot;dynamicOutputs&quot;: {},
        &quot;outputs&quot;: [&quot;out&quot;]
      },
      &quot;/nix/store/wdpicivrj0bmzh935rr1hm1vlk18j0mp-cowsay-3.8.4.drv&quot;: {
        &quot;dynamicOutputs&quot;: {},
        &quot;outputs&quot;: [&quot;out&quot;]
      }
    },
    &quot;inputSrcs&quot;: [
      &quot;/nix/store/shkw4qm9qcw5sc5n1k5jznc83ny02r39-default-builder.sh&quot;,
      &quot;/nix/store/vj1c3wf9c11a0qs6p3ymfvrnsdgsdcbq-source-stdenv.sh&quot;
    ],
    &quot;name&quot;: &quot;mytool&quot;,
    &quot;outputs&quot;: {
      &quot;out&quot;: {
        &quot;path&quot;: &quot;/nix/store/blm702jzcwfppwrrj9925ivd9gxp4c9n-mytool&quot;
      }
    },
    &quot;system&quot;: &quot;x86_64-linux&quot;
  }
}</code></pre>
</section>
<section id="store-derivation" class="slide level2">
<h2>Store Derivation</h2>
<blockquote>
<p>A <strong>derivation</strong> contains only <strong>build
instructions</strong> for Nix to <strong>realize/build</strong> it. This
can be literally anything, e.g.¬†a software package, a wrapper shell
script or only source files.</p>
</blockquote>
</section>
<section id="build-a-derivation" class="slide level2">
<h2>Build A Derivation</h2>
<div class="fragment">
<p>We can build the above derivation - or in other terms <strong>realize
it in the Nix store</strong> - by doing:</p>
<pre class="bash"><code>nix build -L /nix/store/l8pma77py04gd5819zkk3h7jx0bgxqgm-mytool.drv --print-out-paths</code></pre>
</div>
<div class="fragment">
<p>or directly</p>
<pre class="bash"><code>nix build -L &quot;./examples/simple-flake#packages.x86_64-linux.mytool&quot; \
  --print-out-paths --out-link ./mytool</code></pre>
</div>
<div class="fragment">
<p>‚úÖ <strong>Short Form:</strong>
<code>nix build "./examples/simple-flake#mytool"</code> which uses
<code>builtins.currentSystem</code> (works also for macOS users).</p>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>‚úÖ Inspect <code>tree ./mytool</code>:</p>
<pre class="bash"><code>/nix/store/blm702jzc...vd9gxp4c9n-mytool
‚îî‚îÄ‚îÄ bin
    ‚îî‚îÄ‚îÄ mytool</code></pre>
</div><div class="column fragment" style="width:50%;">
<p>‚úÖ Run it with:</p>
<pre class="bash"><code>./mytool/bin/mytool -h</code></pre>
<pre class="bash"><code>nix run &quot;./examples/flake-simple#mytool&quot;</code></pre>
</div>
</div>
</section>
<section id="what-is-an-installable" class="slide level2">
<h2>What Is an Installable</h2>
<div class="fragment">
<p>The path
<code>./examples/flake-simple#packages.x86_64-linux.mytool</code> is
referred to as a <a
href="https://nix.dev/manual/nix/2.24/command-ref/new-cli/nix#flake-output-attribute"
target="_blank">Flake output attribute installable</a>, or simply an <a
href="https://nix.dev/manual/nix/2.24/command-ref/new-cli/nix#installables"
target="_blank"><em>installable</em></a>.</p>
</div>
<div class="fragment">
<p>An <strong>installable</strong> is a Flake output that can be
realized in the Nix store.</p>
</div>
<div>
<ul>
<li class="fragment"><code>./examples/flake-simple</code> refers to this
repository‚Äôs <a href="./flake.nix"><code>flake.nix</code></a>
directory.</li>
<li class="fragment"><code>packages.x86_64-linux.mytool</code> following
<code>#</code> is an output attribute defined within the flake.</li>
</ul>
</div>
<p>Most <a
href="https://nix.dev/manual/nix/2.24/command-ref/experimental-commands"
target="_blank">modern Nix commands</a> accept
<strong>installables</strong> as input, making them a fundamental
concept in working with Flakes. <strong>You should only use the modern
commands, e.g. <code>nix &lt;subcommand&gt;</code></strong>. Stay away
from the command <code>nix-env</code>.</p>
</section>
<section id="exercise" class="slide level2">
<h2>Exercise</h2>
<p>Eval/build/run the <code>treefmt</code> utility in the
<code>packages</code> output in flake directory output <a
href="https://github.com/sdsc-ordes/nix-workshop/blob/main"
target="_blank">root directory</a></p>
<p>Hints:</p>
<ul>
<li><code>nix eval --impure --expr 'builtins.currentSystem'</code></li>
<li><code>packages.${system}.treefmt</code></li>
<li><code>nix run</code></li>
<li><code>"github:sdsc-ordes/nix-workshop#..."</code></li>
</ul>
</section>
<section id="what-is-a-devshell" class="slide level2">
<h2>What Is a DevShell?</h2>
<p>Its a Nix <strong>derivation</strong> in the output attribute set
<code>devShells</code> of the <code>flake.nix</code>:</p>
<pre class="nix" data-line-numbers="8-10"><code>{
  inputs = { /* ... */ };
  outputs = inputs: {
    packages = {
      mytool = /* derivation */
    };

    devShells = {
      banana-shell = /* derivation */
    };

    # ... other output attributes ...
  }
}</code></pre>
<p>The <code>banana-shell</code> derivation is meant to be consumed by
<code>nix develop</code>.</p>
</section>
<section id="create-a-devshell" class="slide level2">
<h2>Create A DevShell</h2>
<p>The flake in <a
href="https://github.com/sdsc-ordes/nix-workshop/blob/main/examples/flake-simple/flake.nix"
target="_blank"><code>./examples/flake-simple</code></a> defines
<code>devShells</code> an output:</p>
<pre class="nix" data-line-numbers="2|3-12|4|5|7-10"><code> devShells = forAllSystems (system:
  let pkgs = inputs.nixpkgs-unstable.legacyPackages.${system}; in
  {
    default = pkgs.mkShell {
      packages = [ pkgs.skopeo pkgs.cowsay ];

      shellHook = &#39;&#39;
        echo &quot;Hello from Shell&quot;
        ${pkgs.cowsay}/bin/cowsay
      &#39;&#39;;
    };
  }
);</code></pre>
<div class="fragment">
<p>Function <code>pkgs.mkShell</code> makes a derivation consumable by
<code>nix develop</code>:</p>
<pre class="bash" style="font-size:14pt"><code>nix develop &quot;github:sdsc-ordes/nix-workshop?dir=examples/flake-simple#default&quot; --command zsh</code></pre>
</div>
</section>
<section id="use-devenv.sh" class="slide level2">
<h2>Use <a href="https://devenv.sh"
target="_blank"><code>devenv.sh</code></a></h2>
<p>Our <a href="https://github.com/sdsc-ordes/repository-template"
target="_blank">best-practice repository templates</a> support
<code>devenv.sh</code> Nix DevShells.</p>
<ul>
<li><p>Nix DevShells from <code>nixpkgs</code>
(<code>pkgs.mkShell</code>) are quite raw and sometimes too
simplistic.</p></li>
<li><p>Nix DevShells from <code>devenv</code> you can do a looot more
stuff, better. To be continued ‚Ä¶</p></li>
<li><p>They are configured based on the same mechanism which drives
<code>NixOS</code> (NixOS Modules).</p></li>
</ul>
</section>
<section id="references" class="slide level2">
<h2>References</h2>
<ul>
<li><p><a href="https://search.nixos.org/packages?" target="_blank">Nix
Packages Search</a></p></li>
<li><p><a href="https://nixhub.io" target="_blank">Nix Packages Search
for Version Pinning</a></p></li>
<li><p><a href="https://nixos.org/manual/nixos/stable/"
target="_blank">NixOS Manual</a></p></li>
<li><p><a href="https://search.nixos.org/options?" target="_blank">NixOS
Options Search</a></p></li>
<li><p><a
href="https://nixos-and-flakes.thiscute.world/nixos-with-flakes"
target="_blank">NixOS With Flakes</a></p></li>
<li><p><a href="https://status.nixos.org/" target="_blank">NixOS
Status</a></p></li>
<li><p><a href="https://nixpk.gs/pr-tracker.html"
target="_blank">Nixpkgs Pull Request Tracker</a></p></li>
<li><p><a href="https://noogle.dev/" target="_blank">Nixpkgs-Lib
Function Search</a></p></li>
</ul>
</section>
<section id="your-nix-journey" class="slide level2">
<h2>Your Nix Journey</h2>
<div>
<ul>
<li class="fragment"><p>‚úÖ Ask the people who set the
<code>devShell</code> how to extend it if you don‚Äôt know yet.</p></li>
<li class="fragment"><p>‚úÖ Check the references.</p></li>
<li class="fragment"><p>More to come in part 2.</p></li>
<li class="fragment"><p>Changing the world of non-reproducible build
systems is hard endeavour on its own.</p></li>
<li class="fragment"><p>Embrace Nix as tool to give you better
reproducibility. The Nix community is always helpful.</p></li>
</ul>
</div>
</section></section>
    </div>
  </div>

  <script src="plugin/code-blocks/move-data-attributes.js"></script>
  <script src="plugin/highlight/add-keywords.js"></script>

  <script src="dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="plugin/markdown/markdown.js"></script>
  <script src="plugin/highlight/highlight.js"></script>
  <script src="plugin/math/math.js"></script>
  <script src="plugin/search/search.js"></script>
  <script src="plugin/zoom/zoom.js"></script>
  <script src="plugin/notes/notes.js"></script>
  <script src="plugin/menu/menu.js"></script>

  <script>
      moveDataAttributesToCodeElement()

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        // Bounds for smallest/largest possible scale to apply to content
        minScale: 0.1,

        maxScale: 2,
        mathjax3: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg-full.js',
          tex: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
          },
        },

        // Reveal Menu Plugin:
        // https://github.com/denehyg/reveal.js-menu/tree/2.1.0?tab=readme-ov-file
        menu: {
            // Specifies which side of the presentation the menu will
            // be shown. Use 'left' or 'right'.
            side: 'left',

            // Specifies the width of the menu.
            // Can be one of the following:
            // 'normal', 'wide', 'third', 'half', 'full', or
            // any valid css length value
            width: 'normal',

            // Add slide numbers to the titles in the slide list.
            // Use 'true' or format string (same as reveal.js slide numbers)
            numbers: false,

            // Specifies which slide elements will be used for generating
            // the slide titles in the menu. The default selects the first
            // heading element found in the slide, but you can specify any
            // valid css selector and the text from the first matching
            // element will be used.
            // Note: that a section data-menu-title attribute or an element
            // with a menu-title class will take precedence over this option
            titleSelector: 'h1, h2, h3, h4, h5, h6',

            // If slides do not have a matching title, attempt to use the
            // start of the text content as the title instead
            useTextContentForMissingTitles: false,

            // Hide slides from the menu that do not have a title.
            // Set to 'true' to only list slides with titles.
            hideMissingTitles: false,

            // Adds markers to the slide titles to indicate the
            // progress through the presentation. Set to 'false'
            // to hide the markers.
            markers: true,

            // Specify custom panels to be included in the menu, by
            // providing an array of objects with 'title', 'icon'
            // properties, and either a 'src' or 'content' property.
            custom: false,

            // Specifies the themes that will be available in the themes
            // menu panel. Set to 'true' to show the themes menu panel
            // with the default themes list. Alternatively, provide an
            // array to specify the themes to make available in the
            // themes menu panel, for example...
            //
            // [
            //     { name: 'Black', theme: 'dist/theme/black.css' },
            //     { name: 'White', theme: 'dist/theme/white.css' },
            //     { name: 'League', theme: 'dist/theme/league.css' },
            //     {
            //       name: 'Dark',
            //       theme: 'lib/reveal.js/dist/theme/black.css',
            //       highlightTheme: 'lib/reveal.js/plugin/highlight/monokai.css'
            //     },
            //     {
            //       name: 'Code: Zenburn',
            //       highlightTheme: 'lib/reveal.js/plugin/highlight/zenburn.css'
            //     }
            // ]
            //
            // Note: specifying highlightTheme without a theme will
            // change the code highlight theme while leaving the
            // presentation theme unchanged.
            themes: false,

            // Specifies the path to the default theme files. If your
            // presentation uses a different path to the standard reveal
            // layout then you need to provide this option, but only
            // when 'themes' is set to 'true'. If you provide your own
            // list of themes or 'themes' is set to 'false' the
            // 'themesPath' option is ignored.
            themesPath: 'dist/theme/',

            // Specifies if the transitions menu panel will be shown.
            // Set to 'true' to show the transitions menu panel with
            // the default transitions list. Alternatively, provide an
            // array to specify the transitions to make available in
            // the transitions panel, for example...
            // ['None', 'Fade', 'Slide']
            transitions: false,

            // Adds a menu button to the slides to open the menu panel.
            // Set to 'false' to hide the button.
            openButton: true,

            // If 'true' allows the slide number in the presentation to
            // open the menu panel. The reveal.js slideNumber option must
            // be displayed for this to take effect
            openSlideNumber: false,

            // If true allows the user to open and navigate the menu using
            // the keyboard. Standard keyboard interaction with reveal
            // will be disabled while the menu is open.
            keyboard: true,

            // Normally the menu will close on user actions such as
            // selecting a menu item, or clicking the presentation area.
            // If 'true', the sticky option will leave the menu open
            // until it is explicitly closed, that is, using the close
            // button or pressing the ESC or m key (when the keyboard
            // interaction option is enabled).
            sticky: false,

            // If 'true' standard menu items will be automatically opened
            // when navigating using the keyboard. Note: this only takes
            // effect when both the 'keyboard' and 'sticky' options are enabled.
            autoOpen: true,

            // If 'true' the menu will not be created until it is explicitly
            // requested by calling RevealMenu.init(). Note this will delay
            // the creation of all menu panels, including custom panels, and
            // the menu button.
            delayInit: false,

            // If 'true' the menu will be shown when the menu is initialised.
            openOnInit: false,

            // By default the menu will load it's own font-awesome library
            // icons. If your presentation needs to load a different
            // font-awesome library the 'loadIcons' option can be set to false
            // and the menu will not attempt to load the font-awesome library.
            loadIcons: true
        },

        highlight: {
          highlightOnLoad: false,
          beforeHighlight: (hljs) => {
            const keywords = new Map([
              [ "bash", [ "nix","curl" ] ]
            ]);
            addHighlightJSKeywords(hljs, keywords)

            // Run the plugin's highlighting code that was skipped on load
            Array.from(Reveal.getRevealElement().querySelectorAll('pre code')).forEach((block) => {
                RevealHighlight().highlightBlock(block);
            });
          }
        },

        // reveal.js plugins
        plugins: [
          RevealNotes,
          RevealSearch,
          RevealZoom,
          RevealHighlight,
          RevealMath.MathJax3,
          RevealMenu
        ]
      }).then(() => {
        // Set two variables for slide and height and width, to scale
        // better code blocks etc.
        Reveal.on('ready', () => {
          const config = Reveal.getConfig();
          document.documentElement.style.setProperty('--slide-height', `px`);
          document.documentElement.style.setProperty('--slide-width', `px`);
        });
      });
    </script>
    </body>
</html>
